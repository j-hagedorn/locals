---
title: "readme"
output: 
  md_document:
    variant: markdown_github
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
df <- read_csv("data/datasets.csv")
```

**Under active development; not ready for use**

# Purpose

This repository contains scripts for reading, transforming and combining datasets that are relevant for analysis of behavioral health and social determinants of health (SDoH) at the local neighborhood level (using 'census tract' as a proxy for 'neighborhood') and, where necessary, county level.  

# Datasets

This list includes datasets which are available at one or more of the following levels of aggregation:

- Address (*allows for geocoding and attribution of location to census tract*)
- Census Tract
- County

These lower levels of aggregation can be rolled up to state level using FIPS codes.

The list of datasets are tracked in the `.csv` file located in the data folder, with more specific documentation found below as issues are identified.  Please push a commit marking the `complete` field in the .csv file as `TRUE`.  There are currently `r sum(df$complete)` datasets completed for inclusion.

```{r echo=FALSE}
df %>%
  mutate(
    datalink = paste0("[",dataset,"](",docs,")"),
    county = if_else(!is.na(county),paste0("[x](",county,")"),""),
    tract = if_else(!is.na(tract),paste0("[x](",tract,")"),""),
    address = if_else(!is.na(address),paste0("[x](",address,")"),""),
  ) %>%
  select(topic,datalink,publisher,county,tract,address) %>%
  arrange(topic) %>%
  knitr::kable()
```

# Processing and Format

There are different output file formats for each level of aggregation in the data.

## Census Tract Dataset

The following fields must be included in all files:

- `dataset`: A shortened name of the dataset, to allow for subsetting when datasets are combined.
- `state`:
- `county`:
- `tract`: The 
- `year`: The year of the published dataset.
- `race`: Should be marked as `pooled` where data is not broken out by race.  Should be marked as `NA` when the variable is not related to a population metric, such as in a count of facilities.
- `gender`: Should be marked as `pooled` where data is not broken out by gender.  Should be marked as `NA` when the variable is not related to a population metric, such as in a count of facilities.
- `age_range`: Should be marked as `pooled` where data is not broken out by age range. Should be marked as `NA` when the variable is not related to a population metric, such as in a count of facilities.
- `var_name`: The name of the variable/metric being reported.
- `value`: The numeric value of the measure identified in `var_name`
- `stat_type`: The type of summary statistic being reported in `value`.  For example: `n`, `mean`, `se`, `median`, etc.

## County-level Dataset

All fields from the census tract level data should be included in all files, other than the `tract` variable.

## Address Dataset

Address-level datasets should include the following fields:

- `dataset`: A shortened name of the dataset, to allow for subsetting when datasets are combined.
- `state`:
- `county`:
- `tract`: The census tract within which the address is located, obtained by using the `TBDfun::census_tract` function.
- `address`:
- `lat`, `lon`: Geocoded latitude and longitude coordinates of `address`
- `year`: The year of the published dataset.
- `...`: Other variables specific to the dataset, which may be of value to retain, though these will not be aggregated in the tract or county-level data.


# Dataset Details

## Census Variables

Variables from the census data (ACS 5-year estimate), including variants of:

- Poverty status
- Disability status
- Percent population over 65
- Health insurance coverage
- Incarceration

```{r census, echo=FALSE}
census_vars <- 
  tidycensus::load_variables(
    2017, "acs5", cache = TRUE
  )
```

## Social Vulnerability Index (CDC) 

This is derived from Census Data and includes, according to the [documentation](https://svi.cdc.gov/Documents/Data/2018_SVI_Data/SVI2018Documentation.pdf), four summary theme ranking variables:

- Socioeconomic
- Household Composition &Disability 
- Minority Status & Language 
- Housing Type & Transportation  

## COVID Cases

From [here](https://github.com/nytimes/covid-19-data/blob/master/README.md)

- Date
- Cases
- Deaths

## COVID Projections

From [here](https://github.com/SenPei-CU/COVID-19_US_Projection/blob/master/README.md)

- Date
- Report Median
- Report 2.5
- Report 25
- Report 75
- Report 97.5
- Total Median
- Total 2.5
- Total 25
- Total 75
- Total 97.5


## Bureau of Labor and Statistics

From [here](https://www.bls.gov/lau/tables.htm):

- Unemployment rate

## County Health Ranking 

County health ranking data includes variables such as the following, as shown in [documentation](https://www.countyhealthrankings.org/sites/default/files/media/document/DataDictionary_2020_2.pdf):

- Premature death
- Poor physical health days
- Poor mental health days
- Food environment index
- Adult smoking

Data available come from various sources, some of which may come from sources available at census tract level [here](https://www.countyhealthrankings.org/explore-health-rankings/measures-data-sources/2020-measures)


## LARA AFC Homes


## Hospitals
